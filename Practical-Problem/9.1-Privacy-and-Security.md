# 隐私与安全

尽管 DeFi 在许多方面展现了令人兴奋的潜力，但目前仍处于早期发展阶段，我们必须诚实地面对它在实践中出现的问题，谨慎地审视相关的投资机会。

## 隐私方面的问题

### 1. 交易透明性
交易的透明性是一把双刃剑，公开透明是公共区块链作为一个分布式账本的基本要求，这个原则维持了区块链的安全。但这也意味着所有 DeFi 交易都是完全透明的，每一笔资金的流向都可以被任何人查询到，这可能导致用户的交易习惯、资金流和策略被公开，对于那些希望保护其金融隐私的用户来说，这是个不能回避的问题。目前也有一些强调隐私的公链正在建设中，但还非常初期，尚未能与目前的 DeFi 生态接轨。

### 2. 关联性分析
最早区块链的宣传特点之一就是“匿名性”，不过这种匿名性是指钱包地址与现实身份的匿名，他人只能查询到某个钱包地址发生了什么交易，而无法直接知晓钱包控制着的信息。

但在实践中，即使交易是匿名的，通过关联分析也可以识别出用户的身份。
- 如某个钱包的活跃时间与交易模式与持有者身份已公开的钱包关联紧密，分析师或恶意参与者就可能能够确定某个地址的真实身份。
- 任何 Web2 身份与 Web3 钱包地址的互动，如从有 KYC 的中心化交易所中提款，也将导致钱包控制者身份的泄露。

### 3. 集中化服务的隐私风险
- 许多 DeFi 应用依赖于集中化的前端或其他服务，如我们访问 Swap 的网页前端可能存放在亚马逊云的服务器上，而亚马逊云会存储访问者的 IP 地址，了解使用者的大致地理位置。
- 公链是全球化的去中心化的，但用于接入公链的 RPC 节点 <sup>[1]</sup> 等其它基础设施，可能是来自大型基础设施服务供应商提供的，这些供应商可能收集访问者的 IP 地址等信息。

## 安全方面的问题

### 1. 代码漏洞
智能合约的代码漏洞是 DeFi 领域最主要的安全隐患，虽然许多 DeFi 项目开源了代码，甚至请专业的安全公司进行代码审计，但代码的复杂性决定了这项工作的高门槛，连专业的审计公司也不能确保 100% 的安全无漏洞。主要可能存在两类问题：

- 代码自身漏洞：智能合约自身或者编译器存在漏洞。如重量级的 DeFi 协议 Curve 被认为非常安全，但由于其使用的 Vyper 编译器的某个版本存在重入攻击漏洞<sup>[2]</sup> ，造成数千万美元的损失。
- 权限漏洞：使用私钥或 MPC 技术控制权限的项目，可能存在权限拥有者监守自盗，或被社会工程学手段盗取私钥后攻击协议造成损失。如 Ronnie 侧链的节点私钥，就因其核心工程师下载了包含木马的 E-Mail 附件，造成数千万美元的损失。

代码漏洞难以完全杜绝，只能将 DeFi 业务模块化，尽量做到精简，依靠时间来检验安全性。如 UniSwap v2 版本的相关代码被广泛 Fork，经受了足够多的市场检验。后续 DeFi 的发展应当借助这种经受过长期考验的安全代码，进行组合演化，用可靠的“砖块”搭建可靠的 DeFi 城堡。

### 2. 前端和中心化服务的安全风险

与上文中心化基础设施导致隐私泄露类似，DeFi 项目的部分环节仍然有中心化服务的参与，如网站前端、媒体运营等，这些环节可能被黑客攻击。

- 基础服务被劫持：通过 DNS 劫持或网站证书伪造，攻击者可以伪造一个外观与官方网站几乎完全一致的假冒前端网页，诱导用户与恶意合约进行交易造成损失。
- 官方媒体被劫持：去中心化的 DeFi 项目仍然会使用中心化的媒体来发布信息，如 Twitter、Discord 等中心化社交媒体，其管理员登陆信息泄露会导致黑客可以借助官方渠道发布假消息，引导用户登陆恶意的网站造成损失。

### 3. 经济攻击
DeFi 协议中的经济机制可能被攻击者利用，不是用智能合约的漏洞，而是在智能合约允许的规则之内，人为制造极端情况进行攻击。

- 例如，通过利用闪电贷 <sup>[3]</sup>，攻击者可以在短时间内借入大量资金，拉高某代币的价格，提高自己抵押物物的账面价值借出大量资金，然后套现归还借款赚取差价，将价格虚高的抵押品留给清算机制。

- 通过资金运作操控冷门代币的价格，在 DeFi 领域中套利。

经济攻击手段往往意味着市场操纵，随着行业发展，闪电贷等技术性的市场操纵手段逐渐被解决，如取过去一段时间内的平均价作为智能合约的喂价等机制已经有效防范。但涉及大体量资金的市场操控行为在可见的将来仍会存在，这是与行业发展处于初期阶段离不开的，较小的流动性、极高的波动性和缺乏监管注定了市场操控的行为难以被完全杜绝。

&#x20;

总的来说，DeFi 领域在隐私和安全方面面临着许多挑战。为了保护自己和自己的资金，用户应该始终保持警惕，确保自己了解参与的项目和协议的风险。

## 引用及注释

<sup>[1]</sup> RPC（Remote Procedure Call）即远程过程调用协议，是一种通过网络从远程计算机上请求服务，而不需要了解底层网络技术的协议。如 Metamask 钱包就使用了公共的 RPC 节点，它们可能是由如 Infura 之类的大型基础设施服务供应商提供的，这些供应商可能收集访问者的 IP 地址等信息。

Infura 官方网站：[www.infura.io](https://www.infura.io/zh)

<sup>[2]</sup> 重入攻击（Reentrancy Attack）是指在函数未结束之前引用自身达到攻击目的，一般依靠“重入锁”来防范，即在一次调用结束前禁止合约状态的改变。Vyper 编译器在 0.2.15、0.2.16、0.3.0 版本存在重入锁设计不合理的 BUG，导致相应的智能合约编译后无法防范重入攻击。

深入探讨重入攻击如何盗走Curve池7000万美元
：[odaily.news](https://www.odaily.news/post/5188865)

<sup>[3]</sup> 闪电贷是 DeFi 领域一种独特的金融工具，不存在于传统金融中。它建立在区块链“非法交易回滚”的特性之上，允许用户无抵押地借出一大笔资金，只要在同一个交易中完胜套利、归还本金及利息的所有操作，借款就可以成立；反之如果最后还款失败，则借款行为本身也会被回滚。闪电贷本身是一个中性的工具，也有许多有正面价值的应用，但同时它也出现在许多黑客攻击的事件中。